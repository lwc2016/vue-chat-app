(function(t){function e(e){for(var r,i,o=e[0],c=e[1],u=e[2],f=0,d=[];f<o.length;f++)i=o[f],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);l&&l(e);while(d.length)d.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],r=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(r=!1)}r&&(s.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},a={app:0},s=[];function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var l=c;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0121":function(t,e,n){"use strict";var r=n("0e61"),a=n.n(r);a.a},"01d3":function(t,e,n){},"0359":function(t,e,n){t.exports=n.p+"img/user-icon.2bf46f49.png"},"03a3":function(t,e,n){"use strict";var r=n("4ce7"),a=n.n(r);a.a},"0b66":function(t,e,n){},"0ba3":function(t,e,n){t.exports=n.p+"img/message-active-icon.153d00f7.png"},"0e61":function(t,e,n){},"10c8":function(t,e,n){},1195:function(t,e,n){t.exports=n.p+"img/avatar.0d652c6a.png"},"224b":function(t,e,n){},2387:function(t,e,n){},2395:function(t,e,n){},"23a1":function(t,e,n){"use strict";var r=n("e329"),a=n.n(r);a.a},"2fa9":function(t,e,n){"use strict";var r=n("2387"),a=n.n(r);a.a},3355:function(t,e,n){"use strict";var r=n("224b"),a=n.n(r);a.a},"34c4":function(t,e,n){"use strict";var r=n("ff51"),a=n.n(r);a.a},4454:function(t,e,n){},4723:function(t,e,n){"use strict";var r=n("509e"),a=n.n(r);a.a},"48f0":function(t,e,n){},"4ce7":function(t,e,n){},"4d71":function(t,e,n){"use strict";var r=n("5a0f"),a=n.n(r);a.a},"509e":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},s=[],i=(n("7c55"),n("2877")),o={},c=Object(i["a"])(o,a,s,!1,null,null,null),u=c.exports,l=n("8c4f"),f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("c-form",{ref:"form",staticClass:"form",attrs:{form:t.form,rules:t.rules}},[n("c-form-item",{attrs:{prop:"name"}},[n("c-input",{attrs:{placeholder:"用户名"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),n("c-form-item",{attrs:{prop:"password"}},[n("c-input",{attrs:{type:"password",placeholder:"密码"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),n("c-form-item",[n("c-button",{on:{click:t.handleSubmit}},[t._v("登录")])],1)],1),n("p",{staticClass:"notice"},[n("router-link",{attrs:{to:"/register"}},[t._v("没有账号？立即注册")])],1)],1)},d=[],m=n("5530"),p={data:function(){return{form:{name:"",password:""},rules:{name:[{required:!0,message:"请填写用户名！"}],password:[{required:!0,message:"请填写密码！"}]}}},methods:{handleSubmit:function(){var t=this;this.$refs.form.validate((function(e){if(e)return t.$message.error(e[0].message);t.$store.dispatch("user/login",Object(m["a"])({},t.form)).then((function(e){t.$message.success("登录成功！"),t.$router.push("/")})).catch((function(e){t.$message.error(e)}))}))}}},v=p,h=(n("70f0"),Object(i["a"])(v,f,d,!1,null,"1dfafe6c",null)),b=h.exports,g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("c-form",{ref:"form",staticClass:"form",attrs:{form:t.form,rules:t.rules}},[n("c-form-item",[n("c-input",{attrs:{type:"text",placeholder:"用户名"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),n("c-form-item",[n("c-input",{attrs:{type:"text",placeholder:"昵称"},model:{value:t.form.nickName,callback:function(e){t.$set(t.form,"nickName",e)},expression:"form.nickName"}})],1),n("c-form-item",[n("c-input",{attrs:{type:"password",placeholder:"密码"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),n("c-form-item",[n("c-input",{attrs:{type:"password",placeholder:"确认密码"},model:{value:t.form.confirmPassword,callback:function(e){t.$set(t.form,"confirmPassword",e)},expression:"form.confirmPassword"}})],1),n("c-form-item",[n("c-button",{on:{click:t.handleSubmit}},[t._v("注册")])],1)],1),n("p",{staticClass:"notice"},[n("router-link",{attrs:{to:"/login"}},[t._v("已有账号？立即登录")])],1)],1)},_=[],k=(n("ac1f"),n("5319"),n("96cf"),n("1da1")),x=(n("d3b7"),n("bc3a")),y=n.n(x),w=function(t,e){var n=r["a"].extend(t),a=new n({propsData:e});return a.$mount(),document.body.appendChild(a.$el),a.remove=function(){a.$destroy(),document.body.removeChild(a.$el)},a},$=function(){var t,e=this,n=e.$createElement,r=e._self._c||n;return r("transition",{attrs:{name:"down"}},[e.isShow?r("div",{class:(t={message:!0},t[e.type]=!0,t)},[e._v(e._s(e.text))]):e._e()])},C=[],O={props:{type:{type:String,default:"success"},text:{type:String,default:""}},data:function(){return{isShow:!1}},methods:{show:function(){this.isShow=!0,setTimeout(this.hide,3e3)},hide:function(){this.isShow=!1,setTimeout(this.remove,1e3)}}},j=O,I=(n("b761"),Object(i["a"])(j,$,C,!1,null,"dd6232ee",null)),R=I.exports,S=y.a.create({baseURL:"/api"});S.interceptors.request.use((function(t){return t}),(function(t){return Promise.reject(t)})),S.interceptors.response.use((function(t){var e=t.status,n=t.data;return 200!==e?Promise.reject(new Error("错误")):200!==n.status?(console.log(n.message),w(R,{type:"error",text:n.message}).show(),Promise.reject(n.message)):n.result}),(function(t){return console.log(t),w(R,{type:"error",text:t}).show(),Promise.reject(t)}));var E=S,N=function(){return E.post("/user/info",{})},P=function(t){return E.post("/user/login",t)},D=function(){return E.post("/user/logout",{})},L=function(t){return E.post("/user/register",t)},U=function(t){return E.post("/user/search",t)},J=function(t){return E.post("/user/detail",t)},T=function(t){return E.post("/user/update",t)},q={data:function(){return{form:{name:"",nickName:"",password:"",confirmPassword:""},rules:{name:[{required:!0,message:"请填写用户名！"}],nickName:[{required:!0,message:"请填写昵称！"}],password:[{required:!0,message:"请填写密码！"}],confirmPassword:[{required:!0,message:"请再次确认密码！"}]}}},methods:{handleSubmit:function(){var t=this;this.$refs.form.validate((function(e){return e?t.$message.error(e[0].message):t.form.password!==t.form.confirmPassword?t.$message.error("两次输入的密码不一致！"):void t.register()}))},register:function(){var t=this;return Object(k["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,L(t.form);case 2:t.$message.success("注册成功，立即登录吧！"),t.$router.replace("/login");case 4:case"end":return e.stop()}}),e)})))()}}},F=q,A=(n("6d48"),Object(i["a"])(F,g,_,!1,null,"f6ca4536",null)),B=A.exports,M=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("router-view")],1)},W=[],z={mounted:function(){this.createWebSocket(),this.$store.dispatch("friend/fetchList")}},G=z,H=(n("3355"),Object(i["a"])(G,M,W,!1,null,"715c5ae4",null)),K=H.exports,Q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("router-view"),n("c-tabBar")],1)},V=[],X={},Y=Object(i["a"])(X,Q,V,!1,null,null,null),Z=Y.exports,tt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.invitations.length>0?n("div",[n("c-title",[t._v("系统消息")]),n("c-session",t._l(t.invitations,(function(e){return n("c-list-item",{key:e.id,attrs:{path:"/invitation/"+e.id,imgUrl:e.avatar,count:e.isRead?0:1},scopedSlots:t._u([{key:"primary",fn:function(){return[t._v(t._s(e.nickName))]},proxy:!0},{key:"secondary",fn:function(){return["invitation_received"===e.subType?n("div",[t._v("请求加为好友，("+t._s(e.remarks)+")")]):t._e(),"invitation_refused"===e.subType?n("div",[t._v("拒绝加你为好友！")]):t._e()]},proxy:!0}],null,!0)})})),1)],1):t._e(),t.messages.length>0?n("div",[n("c-title",[t._v("好友消息")]),n("c-session",t._l(t.messages,(function(e){return n("c-list-item",{key:e.id,attrs:{path:t.$store.state.user.info.id==e.fromId?"/chatRoom/"+e.toId:"/chatRoom/"+e.fromId,imgUrl:e.avatar,count:e.notReadCount},scopedSlots:t._u([{key:"primary",fn:function(){return[t._v(t._s(e.nickName))]},proxy:!0},{key:"secondary",fn:function(){return[t._v(t._s(e.content))]},proxy:!0}],null,!0)})})),1)],1):t._e(),0===t.$store.state.message.list.length?n("c-empty",{attrs:{title:"～ 暂无消息 ～"}}):t._e()],1)},et=[],nt=(n("7db0"),n("c740"),n("4160"),n("159b"),{computed:{messages:function(){var t=this,e=[];return this.$store.state.message.list.forEach((function(n){if("system"===n.type)return null;var r=e.findIndex((function(t){return t.fromId===n.fromId||t.toId===n.fromId}));if(r>=0)e[r].notReadCount+=n.isRead?0:1,e[r]=Object(m["a"])({},e[r],{},n);else{var a=t.$store.state.friend.list.find((function(e){return parseInt(t.$store.state.user.info.id)===parseInt(n.fromId)?parseInt(e.userId)===parseInt(n.toId):parseInt(e.userId)===parseInt(n.fromId)}))||{},s=a.nickName,i=a.avatar;n.notReadCount=n.isRead?0:1,e.push(Object(m["a"])({},n,{nickName:s,avatar:i}))}})),e},invitations:function(){var t=[];return this.$store.state.message.list.forEach((function(e){"system"===e.type&&t.push(e)})),console.log(t),t}}}),rt=nt,at=(n("70a2"),Object(i["a"])(rt,tt,et,!1,null,"278e4ede",null)),st=at.exports,it=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("c-session",[n("c-session-item",{attrs:{path:"/user/search"}},[t._v("添加好友")])],1),t.$store.state.friend.list.length>0?n("div",[n("h3",{staticClass:"title"},[t._v("我的朋友")]),n("c-session",t._l(t.$store.state.friend.list,(function(e){return n("c-list-item",{key:e.id,attrs:{path:"/friend/"+e.id,imgUrl:e.avatar},scopedSlots:t._u([{key:"primary",fn:function(){return[t._v(t._s(e.remarkName||e.nickName))]},proxy:!0},{key:"secondary",fn:function(){return[n("span",[t._v("用户名：")]),t._v(t._s(e.name))]},proxy:!0}],null,!0)})})),1)],1):n("c-empty",{attrs:{title:"～ 暂无好友 ～"}})],1)},ot=[],ct=(n("5c35"),{}),ut=Object(i["a"])(ct,it,ot,!1,null,"9d15aba8",null),lt=ut.exports,ft=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("c-profile",{attrs:{data:t.$store.state.user.info}}),n("c-session",{staticClass:"body"},[n("c-session-item",{attrs:{path:"/person/edit"}},[[t._v("修改个人信息")]],2),n("c-session-item",{on:{click:t.handleClear}},[[t._v("清除消息记录")]],2)],1),n("div",{staticClass:"buttons"},[n("c-button",{attrs:{type:"danger"},on:{click:t.handleLogout}},[t._v("退出登录")])],1)],1)},dt=[],mt={methods:{handleLogout:function(){var t=this;this.$modal.confirm({title:"提示信息",body:"确定需要退出登录吗？",onOk:function(){var e=Object(k["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,D();case 2:t.$store.commit("user/clearDetail"),t.$message.success("退出登录成功！"),t.$router.push("/");case 5:case"end":return e.stop()}}),e)})));function n(){return e.apply(this,arguments)}return n}()})},handleClear:function(){var t=this;this.$modal.confirm({title:"提示信息",body:"确定需要清除信息吗？",onOk:function(){t.$store.commit("message/clear"),t.$message.success("信息清除成功！")}})}}},pt=mt,vt=(n("4723"),Object(i["a"])(pt,ft,dt,!1,null,"3f5fe9de",null)),ht=vt.exports,bt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper"},[n("div",{staticClass:"header"},[n("div",{staticClass:"avatar"},[n("img",{attrs:{src:t.form.avatar}}),n("div",{staticClass:"upload-mask"},[t._v("上传图片")]),n("input",{ref:"file",staticClass:"upload",attrs:{type:"file"},on:{change:t.handleUpload}})])]),n("c-form",{staticClass:"form"},[n("c-form-item",[n("c-input",{attrs:{placeholder:"昵称"},model:{value:t.form.nickName,callback:function(e){t.$set(t.form,"nickName",e)},expression:"form.nickName"}})],1),n("c-form-item",[n("c-textarea",{attrs:{placeholder:"个性签名"},model:{value:t.form.remarks,callback:function(e){t.$set(t.form,"remarks",e)},expression:"form.remarks"}})],1),n("c-form-item",[n("c-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("保存")])],1)],1)],1)},gt=[],_t=function(t){return E.post("/file/upload",t)},kt={data:function(){return{form:{nickName:"",remarks:"",avatar:""}}},mounted:function(){var t=this.$store.state.user.info,e=t.nickName,n=t.avatar,r=t.remarks;this.form.nickName=e,this.form.remarks=r,this.form.avatar=n},methods:{handleSubmit:function(){var t=this;return Object(k["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,T(t.form);case 2:return e.next=4,t.$store.dispatch("user/fetchDetail");case 4:t.$message.success("修改成功！"),t.$router.go(-1);case 6:case"end":return e.stop()}}),e)})))()},handleUpload:function(){var t=this;return Object(k["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.$refs.file.files[0],r=new FormData,r.append("file",n),e.next=5,_t(r);case 5:t.form.avatar=e.sent,t.$message.success("图片上传成功");case 7:case"end":return e.stop()}}),e)})))()}},watch:{"$store.state.user.info":{deep:!0,handler:function(t){var e=t.nickName,n=t.avatar,r=t.remarks;this.form.nickName=e,this.form.remarks=r,this.form.avatar=n}}}},xt=kt,yt=(n("e7da"),Object(i["a"])(xt,bt,gt,!1,null,"5937be51",null)),wt=yt.exports,$t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("c-profile",{attrs:{data:t.detail}}),n("c-form",{staticClass:"form"},[n("c-form-item",{staticClass:"form-group"},[n("c-input",{attrs:{placeholder:"填写备注"},model:{value:t.detail.remarkName,callback:function(e){t.$set(t.detail,"remarkName",e)},expression:"detail.remarkName"}}),n("c-button",{staticClass:"save-btn",on:{click:t.handleUpdate}},[t._v("保存")])],1)],1),n("div",{staticClass:"buttons"},[n("router-link",{attrs:{to:"/chatRoom/"+t.detail.userId}},[n("c-button",[t._v("发消息")])],1),n("c-button",{staticClass:"button",attrs:{type:"danger"}},[t._v("删除好友")])],1)],1)},Ct=[],Ot=function(){return E.post("/friend/list",{})},jt=function(t){return E.post("/friend/detail",t)},It=function(t){return E.post("/friend/update",t)},Rt={data:function(){return{detail:{}}},created:function(){this.fetchDetail()},methods:{fetchDetail:function(){var t=this;return Object(k["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,jt({id:t.$route.params.id});case 2:t.detail=e.sent;case 3:case"end":return e.stop()}}),e)})))()},handleUpdate:function(){var t=this;return Object(k["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,It({id:t.$route.params.id,remarkName:t.detail.remarkName});case 2:t.$store.dispatch("friend/fetchList"),t.$message.success("修改备注成功！");case 4:case"end":return e.stop()}}),e)})))()}}},St=Rt,Et=(n("c543"),Object(i["a"])(St,$t,Ct,!1,null,"1e5b8a1b",null)),Nt=Et.exports,Pt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"header"},[n("c-input",{attrs:{placeholder:"昵称或用户名"},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),n("c-button",{staticClass:"search",on:{click:t.handleSearch}},[t._v("搜索")])],1),n("div",{staticClass:"content"},[n("c-title",[t._v("搜索结果（"),n("span",{staticClass:"red"},[t._v(t._s(t.total))]),t._v("条）")]),n("c-session",t._l(t.list,(function(e){return n("c-list-item",{key:e.id,attrs:{path:"/user/"+e.id,imgUrl:e.avatar},scopedSlots:t._u([{key:"primary",fn:function(){return[t._v(t._s(e.nickName))]},proxy:!0},{key:"secondary",fn:function(){return[n("span",[t._v("用户名：")]),t._v(t._s(e.name))]},proxy:!0}],null,!0)})})),1)],1)])},Dt=[],Lt={data:function(){return{keyword:"",list:[]}},methods:{handleSearch:function(){var t=this;return Object(k["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,U({keyword:t.keyword});case 2:t.list=e.sent;case 3:case"end":return e.stop()}}),e)})))()}},computed:{total:function(){return this.list.length}}},Ut=Lt,Jt=(n("f754"),Object(i["a"])(Ut,Pt,Dt,!1,null,"d55dc914",null)),Tt=Jt.exports,qt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("c-profile",{attrs:{data:t.detail}}),n("c-form",{staticClass:"form"},[n("c-form-item",[n("c-textarea",{attrs:{placeholder:"请填写备注"},model:{value:t.remarks,callback:function(e){t.remarks=e},expression:"remarks"}})],1)],1),n("div",{staticClass:"buttons"},[n("c-button",{staticClass:"button",attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v("添加好友")]),n("c-button",{staticClass:"button",attrs:{type:"danger"}},[t._v("删除好友")])],1)],1)},Ft=[],At=function(t){return E.post("/invitation/send",t)},Bt=function(t){return E.post("/invitation/detail",t)},Mt=function(t){return E.post("/invitation/agree",t)},Wt=function(t){return E.post("/invitation/refuse",t)},zt={data:function(){return{detail:{},remarks:""}},created:function(){this.fetchDetail()},methods:{fetchDetail:function(){var t=this;return Object(k["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,J({id:t.$route.params.id});case 2:t.detail=e.sent;case 3:case"end":return e.stop()}}),e)})))()},handleAdd:function(){var t=this;return Object(k["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,At({userId:t.detail.id,remarks:t.remarks});case 3:t.$message.success("邀请发送成功！"),e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))()}}},Gt=zt,Ht=(n("4d71"),Object(i["a"])(Gt,qt,Ft,!1,null,"afa6a704",null)),Kt=Ht.exports,Qt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("c-profile",{attrs:{data:t.detail}}),n("div",{staticClass:"text"},[t._v(t._s(t.detail.invitationRemarks))]),n("div",{staticClass:"buttons"},[n("c-button",{staticClass:"button",attrs:{type:"danger"},on:{click:t.handleRefuse}},[t._v("拒绝")]),n("c-button",{staticClass:"button",attrs:{type:"primary"},on:{click:t.handleAgree}},[t._v("同意")])],1)],1)},Vt=[],Xt={data:function(){return{detail:{}}},mounted:function(){this.fetchDetail(),this.$store.commit("message/setReadById",this.$route.params.id)},methods:{fetchDetail:function(){var t=this;return Object(k["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Bt({id:t.$route.params.id});case 2:t.detail=e.sent;case 3:case"end":return e.stop()}}),e)})))()},handleAgree:function(){var t=this;return Object(k["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Mt({id:t.$route.params.id});case 2:t.$message.success("好友添加成功！");case 3:case"end":return e.stop()}}),e)})))()},handleRefuse:function(){var t=this;return Object(k["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Wt({id:t.$route.params.id});case 2:t.$message.success("拒绝成功！");case 3:case"end":return e.stop()}}),e)})))()}}},Yt=Xt,Zt=(n("2fa9"),Object(i["a"])(Yt,Qt,Vt,!1,null,"104f7f1b",null)),te=Zt.exports,ee=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("message-content"),n("footer-form")],1)},ne=[],re=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"messages"},t._l(t.list,(function(t,e){return n("message",{key:e,attrs:{data:t}})})),1)},ae=[],se=(n("d81d"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{"message-item":!0,"message-right":t.isSelf}},[n("div",{staticClass:"avatar-box"},[n("img",{staticClass:"avatar",attrs:{src:t.data.avatar}})]),n("div",{staticClass:"message-content"},[n("div",{class:t.isSelf?"arrow-right":"arrow-left"}),n("span",[t._v(t._s(t.data.content))])])])}),ie=[],oe={props:{data:{type:Object,default:function(){return{}}}},computed:{isSelf:function(){return parseInt(this.$store.state.user.info.id)===parseInt(this.data.fromId)}}},ce=oe,ue=(n("34c4"),Object(i["a"])(ce,se,ie,!1,null,"0fac7f6c",null)),le=ue.exports,fe={components:{message:le},computed:{list:function(){var t=this,e=this.$store.state.message.list.map((function(e){if(parseInt(e.fromId)===parseInt(t.$store.state.user.info.id))e.avatar=t.$store.state.user.info.avatar;else{var n=t.$store.state.friend.list.find((function(t){return parseInt(e.fromId)===parseInt(t.userId)}))||{},r=n.avatar;e.avatar=r}return e}));return e}}},de=fe,me=(n("e831"),Object(i["a"])(de,re,ae,!1,null,"f11b2eca",null)),pe=me.exports,ve=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"footer"},[n("div",{ref:"content",staticClass:"input-content",attrs:{contenteditable:"true"}}),n("c-button",{staticClass:"button",on:{click:t.handleSubmit}},[t._v("发送")])],1)},he=[],be=n("9ac5"),ge=n.n(be),_e={data:function(){return{pictureIcon:ge.a}},methods:{handleSubmit:function(){var t=this.$refs.content.textContent,e=this.$route.params.id;t&&(this.$ws.send(JSON.stringify({content:t,toId:e,type:"text"})),this.$refs.content.textContent="")}}},ke=_e,xe=(n("8a83"),Object(i["a"])(ke,ve,he,!1,null,"7ddfed02",null)),ye=xe.exports,we={components:{footerForm:ye,messageContent:pe},mounted:function(){this.$store.commit("message/setRead",this.$route.params.id)}},$e=we,Ce=Object(i["a"])($e,ee,ne,!1,null,null,null),Oe=Ce.exports;r["a"].use(l["a"]);var je=[{path:"/login",component:b,name:"login"},{path:"/register",component:B,name:"register"},{path:"/",component:K,children:[{path:"/",component:Z,children:[{path:"/",component:st,name:"message-list"},{path:"/friend/list",component:lt,name:"friend-list"},{path:"/person",component:ht,name:"person"}]},{path:"/user/search",component:Tt,name:"user-search"},{path:"/user/:id",component:Kt,name:"user-detail"},{path:"/friend/:id",component:Nt,name:"friend-detail"},{path:"/chatRoom/:id",component:Oe,name:"chat-room"},{path:"/invitation/:id",component:te,name:"invitation-detail"},{path:"/person/edit",component:wt,name:"person-edit"}]}],Ie=new l["a"]({mode:"history",base:"/",routes:je}),Re=Ie,Se=n("2f62"),Ee={namespaced:!0,state:{isLogined:!1,isFetched:!1,info:{}},mutations:{setDetail:function(t,e){t.info=e,t.isLogined=!0,t.isFetched=!0},clearDetail:function(t){t.info={},t.isLogined=!1}},actions:{fetchDetail:function(t){return Object(k["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.next=3,N();case 3:r=e.sent,n("setDetail",r);case 5:case"end":return e.stop()}}),e)})))()},login:function(t,e){return Object(k["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,n.next=3,P(e);case 3:a=n.sent,r("setDetail",a);case 5:case"end":return n.stop()}}),n)})))()}}},Ne=(n("13d5"),localStorage.getItem("messages")),Pe=Ne?JSON.parse(Ne):[],De={namespaced:!0,state:{list:Pe},mutations:{push:function(t,e){t.list.push(e),localStorage.setItem("messages",JSON.stringify(t.list))},setRead:function(t,e){t.list.forEach((function(t){parseInt(t.fromId)===parseInt(e)&&(t.isRead=!0)})),localStorage.setItem("messages",JSON.stringify(t.list))},setReadById:function(t,e){t.list.forEach((function(t){parseInt(t.id)===parseInt(e)&&(t.isRead=!0)})),localStorage.setItem("messages",JSON.stringify(t.list))},clear:function(t){t.list=[],localStorage.removeItem("messages")}},getters:{total:function(t){var e=t.list.reduce((function(t,e){return t+=e.isRead?0:1,t}),0);return console.log(e),e}}},Le={namespaced:!0,state:{list:[]},mutations:{setList:function(t,e){t.list=e}},actions:{fetchList:function(t,e){return Object(k["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.next=3,Ot();case 3:r=e.sent,n("setList",r);case 5:case"end":return e.stop()}}),e)})))()}},computed:{total:function(t){return t.list.length}}};r["a"].use(Se["a"]);var Ue=new Se["a"].Store({modules:{user:Ee,message:De,friend:Le}}),Je=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",[t._t("default")],2)},Te=[],qe=n("2a95"),Fe={props:{form:{type:Object,default:function(){}},rules:{type:Object,default:function(){}}},methods:{validate:function(t){var e=new qe["a"](this.rules);e.validate(this.form,t)}}},Ae=Fe,Be=Object(i["a"])(Ae,Je,Te,!1,null,null,null),Me=Be.exports,We=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-item"},[t._t("default")],2)},ze=[],Ge={},He=Ge,Ke=(n("c87b"),Object(i["a"])(He,We,ze,!1,null,"3884617f",null)),Qe=Ke.exports,Ve=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("input",t._b({staticClass:"input",domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}},"input",t.$attrs,!1))},Xe=[],Ye={props:["value"]},Ze=Ye,tn=(n("cdc0"),Object(i["a"])(Ze,Ve,Xe,!1,null,"adfa6b08",null)),en=tn.exports,nn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{class:{button:!0,"primary-btn":"primary"===t.type,"danger-btn":"danger"===t.type},attrs:{type:"button"},on:{click:function(e){return t.$emit("click")}}},[t._t("default")],2)},rn=[],an={props:{type:{type:String,default:"primary"}}},sn=an,on=(n("fa37"),Object(i["a"])(sn,nn,rn,!1,null,"7991c5d0",null)),cn=on.exports,un=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tabbar"},t._l(t.navs,(function(e,r){return n("tab",t._b({key:r,attrs:{active:t.$route.path===e.path}},"tab",e,!1))})),1)},ln=[],fn=n("e124"),dn=n.n(fn),mn=n("0ba3"),pn=n.n(mn),vn=n("adf9"),hn=n.n(vn),bn=n("fb60"),gn=n.n(bn),_n=n("0359"),kn=n.n(_n),xn=n("d6f6"),yn=n.n(xn),wn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("router-link",{staticClass:"tab",attrs:{to:t.path}},[n("div",{staticClass:"tab-icon"},[n("img",{attrs:{src:t.active?t.activeIcon:t.icon}}),t.count?n("div",{staticClass:"count"},[t._v(t._s(t.count))]):t._e()]),n("div",{class:{"tab-text":!0,"tab-text-active":t.active}},[t._v(t._s(t.title))])])},$n=[],Cn={props:["path","icon","activeIcon","active","title","count"]},On=Cn,jn=(n("63a5"),Object(i["a"])(On,wn,$n,!1,null,"6ed6c9c2",null)),In=jn.exports,Rn={components:{tab:In},data:function(){return{navs:[{path:"/",icon:dn.a,activeIcon:pn.a,title:"消息",count:0},{path:"/friend/list",icon:hn.a,activeIcon:gn.a,title:"好友"},{path:"/person",icon:kn.a,activeIcon:yn.a,title:"我的"}]}},mounted:function(){this.navs[0].count=this.$store.getters["message/total"]},watch:{"$store.getters":{handler:function(t){this.navs[0].count=t["message/total"]},deep:!0}}},Sn=Rn,En=(n("23a1"),Object(i["a"])(Sn,un,ln,!1,null,"92e95bd6",null)),Nn=En.exports,Pn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"session"},[t._t("default")],2)},Dn=[],Ln=(n("92f6"),{}),Un=Object(i["a"])(Ln,Pn,Dn,!1,null,"bdf910d0",null),Jn=Un.exports,Tn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"item"},[t.path?n("router-link",{staticClass:"session-item",attrs:{to:t.path}},[n("div",[n("div",{staticClass:"title"},[t._t("default")],2)]),n("div",[n("div",{staticClass:"right-text"}),n("img",{staticClass:"arrow",attrs:{src:t.arrowIcon}})])]):n("div",{staticClass:"session-item",on:{click:function(e){return t.$emit("click")}}},[n("div",[n("div",{staticClass:"title"},[t._t("default")],2)]),n("div",[n("div",{staticClass:"right-text"}),n("img",{staticClass:"arrow",attrs:{src:t.arrowIcon}})])])],1)},qn=[],Fn=n("c5d4"),An=n.n(Fn),Bn={props:{path:{type:String,default:""}},data:function(){return{arrowIcon:An.a}}},Mn=Bn,Wn=(n("5b3b"),Object(i["a"])(Mn,Tn,qn,!1,null,"69d28036",null)),zn=Wn.exports,Gn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"info"},[n("div",{staticClass:"avatar-box"},[n("img",{staticClass:"avatar",attrs:{src:t.data.avatar||t.avatarIcon}})]),n("div",{staticClass:"content"},[n("h3",{staticClass:"nickName"},[t._v(t._s(t.data.remarkName||t.data.nickName))]),n("p",{staticClass:"item"},[n("span",[t._v("账号：")]),n("span",[t._v(t._s(t.data.name))])]),n("p",{staticClass:"item"},[n("span",[t._v("备注：")]),n("span",[t._v(t._s(t.data.remarks||"这人很懒什么都没有留下"))])])])])},Hn=[],Kn=n("1195"),Qn=n.n(Kn),Vn={props:{data:{type:Object,default:function(){return{}}}},data:function(){return{avatarIcon:Qn.a}}},Xn=Vn,Yn=(n("99b5"),Object(i["a"])(Xn,Gn,Hn,!1,null,"a36815d6",null)),Zn=Yn.exports,tr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("router-link",{staticClass:"friend",attrs:{to:"/friend/"+t.data.userId}},[n("div",{staticClass:"logo"},[n("img",{attrs:{src:t.data.avatar}})]),n("div",{staticClass:"info"},[n("h3",{staticClass:"name"},[t._v(t._s(t.data.nickName))]),n("p",{staticClass:"username"},[t._v(t._s(t.data.name))])])])},er=[],nr={props:{data:{type:Object,default:function(){return{}}}}},rr=nr,ar=(n("b5cf"),Object(i["a"])(rr,tr,er,!1,null,"bd367ba6",null)),sr=ar.exports,ir=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("h3",{staticClass:"title"},[t._t("default")],2)},or=[],cr={},ur=cr,lr=(n("9d3e"),Object(i["a"])(ur,ir,or,!1,null,"fdacf5d4",null)),fr=lr.exports,dr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"box"},[n("transition",{attrs:{name:"fade"}},[t.isShow?n("div",{staticClass:"mask"}):t._e()]),n("transition",{attrs:{name:"fade"}},[t.isShow?n("div",{staticClass:"modal"},[n("div",{staticClass:"modal-title"},[t._v(t._s(t.title))]),n("div",{staticClass:"modal-body"},[t._v(t._s(t.body))]),n("div",{staticClass:"modal-footer"},[n("div",{staticClass:"btn btn-left",on:{click:t.hide}},[t._v("关闭")]),n("div",{staticClass:"btn btn-right",on:{click:t.handleOk}},[t._v("确定")])])]):t._e()])],1)},mr=[],pr={props:{title:{type:String,default:""},body:{type:String,default:""},onOk:{type:Function,default:function(){}}},data:function(){return{isShow:!1}},methods:{show:function(){this.isShow=!0},hide:function(){this.isShow=!1,setTimeout(this.remove,1e3)},handleOk:function(){this.hide(),this.onOk&&this.onOk()}}},vr=pr,hr=(n("0121"),Object(i["a"])(vr,dr,mr,!1,null,"36fe75b2",null)),br=hr.exports,gr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("textarea",t._b({staticClass:"textarea",domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}},"textarea",t.$attrs,!1))},_r=[],kr={props:["value"]},xr=kr,yr=(n("bea5"),Object(i["a"])(xr,gr,_r,!1,null,"666e72d0",null)),wr=yr.exports,$r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"list-item"},[n("router-link",{staticClass:"message",attrs:{to:t.path}},[n("div",{staticClass:"left"},[n("div",{staticClass:"logo"},[n("img",{attrs:{src:t.imgUrl||t.defaultIcon}})]),t.count?n("div",{staticClass:"count"},[t._v(t._s(t.count))]):t._e()]),n("div",{staticClass:"info"},[n("h3",{staticClass:"name"},[t._t("primary")],2),n("p",{staticClass:"content"},[t._t("secondary")],2)])])],1)},Cr=[],Or={props:["path","imgUrl","count"],data:function(){return{defaultIcon:Qn.a}}},jr=Or,Ir=(n("03a3"),Object(i["a"])(jr,$r,Cr,!1,null,"0694ccf0",null)),Rr=Ir.exports,Sr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"empty"},[n("img",{staticClass:"empty-icon",attrs:{src:t.emptyIcon}}),n("p",{staticClass:"notice"},[t._v(t._s(t.title))])])},Er=[],Nr=n("74fb"),Pr=n.n(Nr),Dr={props:["title"],data:function(){return{emptyIcon:Pr.a}}},Lr=Dr,Ur=(n("9f58"),Object(i["a"])(Lr,Sr,Er,!1,null,"05df5d58",null)),Jr=Ur.exports,Tr=function(t){t.component("c-form",Me),t.component("c-form-item",Qe),t.component("c-input",en),t.component("c-button",cn),t.component("c-tabBar",Nn),t.component("c-session",Jn),t.component("c-session-item",zn),t.component("c-profile",Zn),t.component("c-friend",sr),t.component("c-title",fr),t.component("c-textarea",wr),t.component("c-list-item",Rr),t.component("c-empty",Jr),t.prototype.$message={success:function(t){return w(R,{type:"success",text:t}).show()},error:function(t){return w(R,{type:"error",text:t}).show()}},t.prototype.$modal={confirm:function(t){return w(br,t).show()}}},qr={install:Tr},Fr=(n("caad"),["/login","/register"]),Ar=function(t,e){t.beforeEach(function(){var t=Object(k["a"])(regeneratorRuntime.mark((function t(n,r,a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a(),!Fr.includes(n.path)){t.next=5;break}a(),t.next=25;break;case 5:if(!e.state.user.isLogined){t.next=10;break}console.log("-----已经登录了------"),a(),t.next=25;break;case 10:if(!e.state.user.isFetched){t.next=15;break}console.log("-----需要重新登录-------"),a("/login"),t.next=25;break;case 15:return console.log("-----获取用户信息-----"),t.prev=16,t.next=19,e.dispatch("user/fetchDetail");case 19:a(),t.next=25;break;case 22:t.prev=22,t.t0=t["catch"](16),a("/login");case 25:case"end":return t.stop()}}),t,null,[[16,22]])})));return function(e,n,r){return t.apply(this,arguments)}}())};n("b0c0");function Br(t){t.mixin({methods:{createWebSocket:function(){var e=this;if(!t.prototype.$ws){var n="ws://chatroom.supersummer.top:3030",r=new WebSocket(n);r.onopen=function(){},r.onmessage=function(t){var n=JSON.parse(t.data);n.isRead="chat-room"===e.$route.name,e.$store.commit("message/push",n)},r.onclose=function(){},t.prototype.$ws=r}}}})}var Mr={install:Br};r["a"].config.productionTip=!1,r["a"].use(qr),r["a"].use(Mr),Ar(Re,Ue),new r["a"]({router:Re,store:Ue,render:function(t){return t(u)}}).$mount("#app")},5908:function(t,e,n){},"5a0f":function(t,e,n){},"5b3b":function(t,e,n){"use strict";var r=n("6c27"),a=n.n(r);a.a},"5c35":function(t,e,n){"use strict";var r=n("61ae"),a=n.n(r);a.a},"5c51":function(t,e,n){},"5f96":function(t,e,n){},"61ae":function(t,e,n){},"63a5":function(t,e,n){"use strict";var r=n("10c8"),a=n.n(r);a.a},"64d7":function(t,e,n){},"6c27":function(t,e,n){},"6d48":function(t,e,n){"use strict";var r=n("5c51"),a=n.n(r);a.a},"70a2":function(t,e,n){"use strict";var r=n("ee59"),a=n.n(r);a.a},"70f0":function(t,e,n){"use strict";var r=n("48f0"),a=n.n(r);a.a},7371:function(t,e,n){},"74fb":function(t,e,n){t.exports=n.p+"img/empty-box.28fbd3db.png"},"78b9":function(t,e,n){},"7a03":function(t,e,n){},"7c55":function(t,e,n){"use strict";var r=n("2395"),a=n.n(r);a.a},"8a83":function(t,e,n){"use strict";var r=n("a317"),a=n.n(r);a.a},"92f6":function(t,e,n){"use strict";var r=n("b93e"),a=n.n(r);a.a},"99b5":function(t,e,n){"use strict";var r=n("0b66"),a=n.n(r);a.a},"9ac5":function(t,e,n){t.exports=n.p+"img/picture.b34fefdc.png"},"9d3e":function(t,e,n){"use strict";var r=n("01d3"),a=n.n(r);a.a},"9d7c":function(t,e,n){},"9e45":function(t,e,n){},"9f58":function(t,e,n){"use strict";var r=n("64d7"),a=n.n(r);a.a},a317:function(t,e,n){},a591:function(t,e,n){},adf9:function(t,e,n){t.exports=n.p+"img/friends-icon.9b5e898e.png"},b5cf:function(t,e,n){"use strict";var r=n("7371"),a=n.n(r);a.a},b761:function(t,e,n){"use strict";var r=n("78b9"),a=n.n(r);a.a},b93e:function(t,e,n){},bea5:function(t,e,n){"use strict";var r=n("a591"),a=n.n(r);a.a},c543:function(t,e,n){"use strict";var r=n("4454"),a=n.n(r);a.a},c5d4:function(t,e,n){t.exports=n.p+"img/arrow.a7937ad8.png"},c87b:function(t,e,n){"use strict";var r=n("9d7c"),a=n.n(r);a.a},cdc0:function(t,e,n){"use strict";var r=n("7a03"),a=n.n(r);a.a},d299:function(t,e,n){},d6f6:function(t,e,n){t.exports=n.p+"img/user-active-icon.5bc121f1.png"},e124:function(t,e,n){t.exports=n.p+"img/message-icon.d5b0beda.png"},e329:function(t,e,n){},e7da:function(t,e,n){"use strict";var r=n("9e45"),a=n.n(r);a.a},e831:function(t,e,n){"use strict";var r=n("5f96"),a=n.n(r);a.a},ee59:function(t,e,n){},f754:function(t,e,n){"use strict";var r=n("d299"),a=n.n(r);a.a},fa37:function(t,e,n){"use strict";var r=n("5908"),a=n.n(r);a.a},fb60:function(t,e,n){t.exports=n.p+"img/friends-active-icon.de0a54c9.png"},ff51:function(t,e,n){}});
//# sourceMappingURL=app.f645a201.js.map